# Aircok Data Manager  
**バージョン: v1.0.1（2025年4月）**

Aircok Data Managerは、微小粒子状物質（PM）、温湿度、CO₂のデータを基準機器と比較し、補正およびレポートを自動生成するためのツールです。センサーデータの精度向上とExcel形式での結果出力を目的としています。

---

## 🧩 主な機能

### 1. ファイルの読み込み
基準データおよびAircok装置のデータを選択して読み込みます。  
ユーザーフレンドリーなUIにより、ファイル選択とデータ取得が簡単に行えます。

### 2. データ補正の実行
**[Calibration]** ボタンをクリックすることで、自動補正アルゴリズムが実行され、精密な補正が行われます。

### 3. 補正結果の確認
補正されたデータはアプリケーション内で直接確認でき、前後のシートをボタンでナビゲート可能です。

### 4. 補正結果のエクスポート
**[補正結果の生成]** ボタンをクリックすると、センサーごとの補正結果をExcelファイルとして出力できます。

### 5. 総合レポートの生成
**[レポート生成]** ボタンで統合された全データをExcel形式でレポート出力します。

---

## 🔧 追加ツール

### ▪ Aircok Log Converter
AircokのLCDモデルは、ログデータを`.txt`形式でSDカードに保存します。  
このツールは、それらのログをCSVフォーマットに変換し、可読性を向上させます。

### ▪ Aircok Data Extractor
PostgreSQLデータベースに保存されたAircokのデータをGUIを通じて簡単にダウンロード可能です。

---

## 📈 補正アルゴリズムについて

### ▪ PM2.5 / PM10補正
XGBoostモデルを用いた3段階の補正処理：

1. **濃度レンジの分類**  
   微粒子濃度を `[10-30]`, `[31-60]`, `[61-100]`, `[101-200]` の4つの区間に分割。

2. **補正係数の算出**  
   GRIMMとAircokのセンサーデータを比較し、比率をベースとした補正係数を計算。  
   XGBoostモデルにより比率を予測し、中央値を基に補正値を最終決定。

3. **精度の評価**  
   補正前後のデータを比較し、精度の向上を評価。

### ▪ 温度 / 湿度 / CO₂の補正
- Aircokと基準装置の平均値の差を計算し、簡易な補正式を適用。
- これらのデータは変動が小さいため、単純な平均差による補正でも十分な精度が得られます。
- 補正前後の比較により改善効果を確認可能です。

---

## 🖥️ スクリーンショット

### ▪ メイン画面  
![image](https://github.com/user-attachments/assets/5a5bf2dd-024c-4784-8bc7-1405696ee52d)

### ▪ Aircok Data Extractor  
![image](https://github.com/user-attachments/assets/675aaa13-0c09-40d0-9d79-c679a3e02e67)

### ▪ Aircok Log Converter  
![image](https://github.com/user-attachments/assets/8fc250bf-309c-42f2-a916-169620c75000)

---

## 🚀 実行手順

1. `Aircok Data Manager.zip` をダウンロードします。  
2. 解凍後、`Aircok Data Manager v1.0.1.exe` を実行してください。

---

## 💻 推奨動作環境

- **OS：** Windows 11 以降  
- **メモリ：** 8GB 以上

> ⚠️ **ご注意：** 本ツールは現在もテスト中であり、安定性は完全には保証されていません。  
> 推奨スペック未満の環境では動作しない、あるいは予期せぬ不具合が発生する可能性があります。

---

## 📦 バージョン履歴

### v1.0.1 (2025年4月)
- 🐞 PMおよびCO₂補正の不具合修正

### v1.0.0 (2025年4月)
- 🎉 正式リリース：機能安定化

### v1.0.0-rc.1 (2025年4月)
- 🔧 最終最適化および修正

### v1.0.0-beta (2025年4月)
- 🧪 パフォーマンスと安定性のテスト

### v1.0.0-alpha.5 (2025年4月)
- ➕ 補正結果出力機能を追加  
- ➕ センサー別の平均シートを追加

### v1.0.0-alpha.4 (2025年4月)
- ➕ 運用/テストDB切替機能追加  
- ➕ サーバー選択機能追加

### v1.0.0-alpha.3 (2025年3月)
- ➕ Aircokデータダウンロード機能追加  
- 🐞 レポート生成失敗のバグ修正  
- ⚙ レポート生成性能の改善

### v1.0.0-alpha.2 (2024年12月)
- ➕ データ初期化機能追加  
- ➕ ログ変換ツール追加

### v1.0.0-alpha.1 (2024年12月)
- 🐞 CO₂補正処理のバグ修正  
- ➕ レポート生成と出力機能追加

### v1.0.0-alpha (2024年11月)
- 🚀 最初のアルファリリース：ファイル選択、補正、レポート機能搭載

---

## 🛠 使用技術

- **Python 3.10+**
- **PyQt5**
- **pandas**
- **XGBoost**
- **SQLAlchemy + PostgreSQL**
